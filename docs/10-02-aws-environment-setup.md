# AWS 環境準備編 - アカウント作成から基本設定まで

## 🎯 この章の目標

AWS（Amazon Web Services）アカウントを作成し、AI エージェントを動かすための基本設定を行います。

## 📋 作業の流れ

1. **AWS アカウント作成** (初回のみ)
2. **IAM ユーザー作成** (セキュリティのため)
3. **AWS CLI インストール** (コマンドライン操作用)
4. **認証情報設定** (アクセス権限の設定)

---

## ステップ 1: AWS アカウント作成

### 🌐 AWS 公式サイトにアクセス

1. ブラウザで https://aws.amazon.com/jp/ を開く
2. **「無料でサインアップ」** ボタンをクリック

### 📝 アカウント情報入力

1. **E メールアドレス**: 普段使うメールアドレス
2. **パスワード**: 8文字以上、大文字・小文字・数字を含む
3. **AWS アカウント名**: 分かりやすい名前（例: "my-ai-project"）

### 💳 支払い情報の設定

**注意**: クレジットカードが必要ですが、このプロジェクトは **AWS 無料利用枠** 内で動作します。

1. **クレジットカード情報**を入力
2. **請求先住所**を入力
3. **SMS 認証**で電話番号確認

### ✅ 確認事項
- ✅ 登録したメールアドレスに確認メールが届く
- ✅ AWS マネジメントコンソールにログインできる

---

## ステップ 2: IAM ユーザー作成

> **なぜ IAM ユーザーが必要？**  
> ルートアカウント（最初に作ったアカウント）は権限が強すぎるため、日常の作業用に制限されたユーザーを作ります。

### 🔐 IAM サービスにアクセス

1. **AWS マネジメントコンソール**にログイン
2. **サービス検索**で「IAM」と入力
3. **IAM** をクリック

### 👤 新しいユーザーを作成

1. 左メニューから **「ユーザー」** をクリック
2. **「ユーザーを作成」** ボタンをクリック
3. **ユーザー名**: `strands-agentcore-user`（覚えやすい名前でOK）
4. **「次へ」** をクリック

### 🛡️ 権限の設定

1. **「ポリシーを直接アタッチする」** を選択
2. 以下のポリシーを検索してチェック:
   - ✅ `AmazonBedrockFullAccess`
   - ✅ `BedrockAgentCoreFullAccess`
   - ✅ `AmazonEC2ContainerRegistryFullAccess`
   - ✅ `IAMFullAccess`
   - ✅ `AmazonS3FullAccess`
   - ✅ `AWSCodeBuildDeveloperAccess`
   - ✅ `CloudWatchFullAccessV2`
   - ✅ `AWSXrayFullAccess`

3. **「次へ」** → **「ユーザーの作成」** をクリック

### 🔑 アクセスキーの作成

1. 作成したユーザー名をクリック
2. **「セキュリティ認証情報」** タブをクリック
3. **「アクセスキーを作成」** をクリック
4. **「コマンドラインインターフェイス (CLI)」** を選択
5. 確認チェックボックスにチェック → **「次へ」**
6. **「アクセスキーを作成」** をクリック

### 📋 重要な情報をメモ

以下の情報を**安全な場所**にメモしてください：

```
アクセスキー ID: AKIA ではじまる文字列
シークレットアクセスキー: 長い英数字の文字列
```

> **⚠️ 重要**: シークレットアクセスキーは二度と表示されません！必ずメモしてください。

---

## ステップ 3: AWS CLI インストール

### 💻 macOS の場合

1. **ターミナル**を開く（アプリケーション → ユーティリティ → ターミナル）
2. 以下のコマンドを実行:

```bash
# Homebrew がインストールされている場合
brew install awscli

# または公式インストーラーをダウンロード
curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"
sudo installer -pkg AWSCLIV2.pkg -target /
```

### 🖥️ Windows の場合

1. https://awscli.amazonaws.com/AWSCLIV2.msi をダウンロード
2. ダウンロードしたファイルを実行してインストール
3. **コマンドプロンプト**または **PowerShell** を開く

### ✅ インストール確認

```bash
aws --version
```

正常にインストールされていれば、バージョン情報が表示されます。

---

## ステップ 4: AWS 認証情報設定

### 🔧 AWS CLI の設定

ターミナル（またはコマンドプロンプト）で以下を実行:

```bash
aws configure
```

以下の情報を順番に入力:

```
AWS Access Key ID [None]: (先ほどメモしたアクセスキーID)
AWS Secret Access Key [None]: (先ほどメモしたシークレットアクセスキー)
Default region name [None]: us-west-2
Default output format [None]: json
```

### ✅ 設定確認

```bash
aws sts get-caller-identity
```

以下のような出力が表示されれば成功:

```json
{
    "UserId": "AIDACKCEVSQ6C2EXAMPLE",
    "Account": "123456789012",
    "Arn": "arn:aws:iam::123456789012:user/strands-agentcore-user"
}
```

---

## 💰 料金について

### 無料利用枠の範囲

このプロジェクトで使用する AWS サービスは、以下の無料枠内で動作します:

- **Bedrock**: 月 20,000 リクエスト
- **ECR**: 500MB ストレージ
- **S3**: 5GB ストレージ
- **CloudWatch**: 基本メトリクス
- **CodeBuild**: 月 100 分

### 📊 料金監視の設定

1. **AWS マネジメントコンソール** → **請求とコスト管理**
2. **予算** → **予算を作成**
3. **コスト予算** → 月額 $5 の予算を設定
4. **アラート設定**: 80% で通知メール

---

## 🚨 トラブルシューティング

### よくある問題と解決方法

#### 1. 「アクセス拒否」エラー
```
解決方法:
- IAM ユーザーの権限設定を再確認
- ポリシーが正しくアタッチされているか確認
```

#### 2. AWS CLI のコマンドが認識されない
```
解決方法:
- PATH 環境変数の設定確認
- ターミナル/コマンドプロンプトの再起動
- AWS CLI の再インストール
```

#### 3. 認証情報エラー
```
解決方法:
- aws configure で設定を再確認
- アクセスキーの入力ミスをチェック
- IAM ユーザーが有効か確認
```

### 🆘 困ったときのチェックリスト

- [ ] AWS アカウントにログインできる
- [ ] IAM ユーザーが作成されている
- [ ] 必要なポリシーがアタッチされている
- [ ] AWS CLI がインストールされている
- [ ] `aws sts get-caller-identity` が成功する

---

## 🎊 完了確認

以下がすべて完了していれば、次の章に進めます:

- ✅ AWS アカウント作成完了
- ✅ IAM ユーザー作成・権限設定完了
- ✅ AWS CLI インストール・設定完了
- ✅ 認証テスト成功

## 📌 この章で学んだこと

- ✅ AWS アカウントの作成方法
- ✅ セキュリティのための IAM ユーザー作成
- ✅ AWS CLI のインストールと設定
- ✅ 料金監視の重要性

**次の章**: 10-03 開発環境セットアップ編

---

## 📚 用語解説

- **AWS**: Amazon Web Services、クラウドサービス
- **IAM**: Identity and Access Management、ユーザー・権限管理
- **CLI**: Command Line Interface、コマンドライン操作ツール
- **アクセスキー**: AWS サービスを操作するためのパスワード的な情報
- **リージョン**: AWS のデータセンターの場所（us-west-2 = オレゴン州）